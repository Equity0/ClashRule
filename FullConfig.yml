# Updated Time: 2023/12/16 00:32:00(UTC+8)

mixed-port: 7890
# redir-port: 7892 # é€æ˜ä»£ç†ç«¯å£ï¼Œç”¨äº Linux å’Œ MacOS
# tproxy-port: 7895 # Transparent proxy server port for Linux (TProxy TCP and TProxy UDP)

# ============================================
# å…è®¸å±€åŸŸç½‘çš„å…¶ä»–è®¾å¤‡ç»è¿‡ Clash çš„ä»£ç†ç«¯å£è®¿é—®äº’è”ç½‘
allow-lan: true 
# ä»…åœ¨å°†allow-lanè®¾ç½®ä¸ºtrueæ—¶é€‚ç”¨
# #"*": ç»‘å®šæ‰€æœ‰IPåœ°å€
# #192.168.122.11: ç»‘å®šå•ä¸ªIPv4åœ°å€
# #"[aaaa::a8aa:ff:fe09:57d8]": ç»‘å®šå•ä¸ªIPv6åœ°å€
bind-address: "*"
#authentication: # http,sockså…¥å£çš„éªŒè¯ç”¨æˆ·åï¼Œå¯†ç 
#  - "clash:7bMLMUwJ6a"
skip-auth-prefixes: # è®¾ç½®è·³è¿‡éªŒè¯çš„IPæ®µ
  - 127.0.0.1/8
  - ::1/128

# ============================================
mode: rule
log-level: info
ipv6: false # å†…æ ¸ä¸æ¥å— IPv6 æµé‡
keep-alive-interval: 30 # æ§åˆ¶ Clash å‘å‡º TCP Keep Alive åŒ…çš„é—´éš”ï¼Œå‡å°‘ç§»åŠ¨è®¾å¤‡è€—ç”µé—®é¢˜çš„ä¸´æ—¶æªæ–½ã€‚

# ========== å¤–éƒ¨æ§åˆ¶å™¨ ============================
# å¤–éƒ¨æ§åˆ¶å™¨ï¼Œå¯ä»¥ä½¿ç”¨ RESTful API æ¥æ§åˆ¶ä½ çš„ Clash å†…æ ¸
external-controller: 0.0.0.0:9090
#secret: "123456" # RESTful API çš„å£ä»¤ (å¯é€‰)

# æ‚¨å¯ä»¥å°†é™æ€ç½‘é¡µèµ„æºï¼ˆå¦‚ clash-dashboardï¼‰æ”¾ç½®åœ¨ä¸€ä¸ªç›®å½•ä¸­ï¼Œclash å°†ä¼šæœåŠ¡äº `RESTful API/ui`
# å‚æ•°åº”å¡«å†™é…ç½®ç›®å½•çš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚
# http://127.0.0.1:9090/ui/#/
# external-ui: folder
# yacdé¢æ¿ï¼š  https://github.com/haishanh/yacd
# Razordé¢æ¿ï¼šhttp://clash.razord.top/#/proxies
# external-ui: dashboard

# è‡ªå®šä¹‰å¤–éƒ¨ç”¨æˆ·ç•Œé¢ä¸‹è½½åœ°å€
# ä» GitHub Pages åˆ†æ”¯è·å–
external-ui-url: "https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip" 



# ============== GeoData ======================
# æ›´æ”¹geoipä½¿ç”¨æ–‡ä»¶,mmdbæˆ–è€…dat,å¯é€‰ true/false,trueä¸ºdat,æ­¤é¡¹æœ‰é»˜è®¤å€¼ false
geodata-mode: false

# GEOæ–‡ä»¶åŠ è½½æ¨¡å¼Â¶
# å¯é€‰çš„åŠ è½½æ¨¡å¼å¦‚ä¸‹
# standardï¼šæ ‡å‡†åŠ è½½å™¨
# memconservativeï¼šä¸“ä¸ºå†…å­˜å—é™(å°å†…å­˜)è®¾å¤‡ä¼˜åŒ–çš„åŠ è½½å™¨(é»˜è®¤å€¼)
geodata-loader: standard

# è‡ªåŠ¨æ›´æ–° GEOÂ¶
geo-auto-update: true

# æ›´æ–°é—´éš”,å•ä½å°æ—¶
geo-update-interval: 24

# è‡ªå®š GEO ä¸‹è½½åœ°å€
geox-url:
  geoip: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geoip.dat"
  geosite: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geosite.dat"
  mmdb: "https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/Country.mmdb"

# geo ç±»åˆ«æŸ¥è¯¢ç›®å½•:
# geoip.dat æ‰€æœ‰ç±»åˆ«ï¼šhttps://github.com/Loyalsoldier/geoip/tree/release/text
# geosite.dat æ‰€æœ‰ç±»åˆ«ï¼šhttps://github.com/v2fly/domain-list-community/tree/master/data
# geosite.dat é™¤äº†åŒ…å«åŸæœ¬çš„æ‰€æœ‰ç±»åˆ«ï¼Œä¹ŸåŒ…å« [README](https://github.com/Loyalsoldier/v2ray-rules-dat?tab=readme-ov-file#geositedat) é‡Œæ–°å¢çš„ç±»åˆ«ã€‚

# è‡ªå®šä¹‰å¤–éƒ¨èµ„æºä¸‹è½½æ—¶ä½¿ç”¨çš„çš„UA,é»˜è®¤ä¸º clash.meta
# global-ua: clash.meta
# ==========================================

# å…¨å±€ TLS æŒ‡çº¹ï¼Œä¼˜å…ˆä½äº proxy å†…çš„ client-fingerprintã€‚
# ç›®å‰æ”¯æŒå¼€å¯ TLS ä¼ è¾“çš„ TCP/grpc/WS/HTTP , æ”¯æŒåè®®æœ‰ VLESS,Vmess å’Œ trojan.
# global-client-fingerprint: random


# åœ¨ Clash å®˜æ–¹ä¸­ï¼Œprofile åº”ä¸ºæ‰©å±•é…ç½®ï¼Œä½†åœ¨ Clash.meta, ä»…ä½œä¸ºç¼“å­˜é¡¹ä½¿ç”¨
profile:
  store-selected: true # å‚¨å­˜ API å¯¹ç­–ç•¥ç»„çš„é€‰æ‹©ï¼Œä»¥ä¾›ä¸‹æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨
  store-fake-ip: true # æŒä¹…åŒ– fake-ip.å‚¨å­˜ fakeip æ˜ å°„è¡¨ï¼ŒåŸŸåå†æ¬¡å‘ç”Ÿè¿æ¥æ—¶ï¼Œä½¿ç”¨åŸæœ‰æ˜ å°„åœ°å€

tun:
  enable: true
  stack: mixed
  dns-hijack:
    - any:53
    - tcp://any:53

dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:7874 # DNS æœåŠ¡ç›‘å¬
  prefer-h3: true # æ˜¯å¦å¼€å¯ DOH çš„ http/3
  enhanced-mode: fake-ip # Clash çš„ DNS å¤„ç†æ¨¡å¼
  fake-ip-range: 198.18.0.1/16 # fakeip ä¸‹çš„ IP æ®µè®¾ç½®
  fake-ip-filter: # fakeip è¿‡æ»¤ï¼Œä»¥ä¸‹åœ°å€ä¸ä¼šä¸‹å‘ fakeip æ˜ å°„ç”¨äºè¿æ¥
    - '*.lan'
    - '+.local'
    - localhost.ptlogin2.qq.com
  default-nameserver: # é»˜è®¤ DNS, ç”¨äºè§£æ DNS æœåŠ¡å™¨ çš„åŸŸå. å¿…é¡»ä¸º IP, å¯ä¸ºåŠ å¯† DNS
    - 8.8.8.8
    - 1.0.0.1
    - 114.114.114.114
    - 223.5.5.5
    - system
  # æŒ‡å®šåŸŸåæŸ¥è¯¢çš„è§£ææœåŠ¡å™¨ï¼Œå¯ä½¿ç”¨ geosite, ä¼˜å…ˆäº nameserver/fallback æŸ¥è¯¢
  nameserver-policy:
    'geosite:cn,private':
      - tls://120.53.53.53
      - tls://223.5.5.5:853
      - https://doh.pub/dns-query
    'geosite:geolocation-!cn':
      - tls://8.8.4.4
      - https://dns.google/dns-query
      - https://1.0.0.1/dns-query
      - https://jp.tiarap.org/dns-query
  # é»˜è®¤çš„åŸŸåè§£ææœåŠ¡å™¨ï¼Œå¦‚ä¸é…ç½® fallback/proxy-server-nameserver , åˆ™æ‰€æœ‰åŸŸåéƒ½ç”± nameserver è§£æ
  # ä¸»è¦ DNS é…ç½®ï¼Œå½±å“æ‰€æœ‰ç›´è¿ï¼Œç¡®ä¿ä½¿ç”¨å¯¹å¤§é™†è§£æç²¾å‡†çš„ DNS
  nameserver:
    - tls://120.53.53.53
    - tls://223.5.5.5:853
    - https://dns.alidns.com/dns-query
  # ä»£ç†èŠ‚ç‚¹åŸŸåè§£ææœåŠ¡å™¨ï¼Œä»…ç”¨äºè§£æä»£ç†èŠ‚ç‚¹çš„åŸŸå
  proxy-server-nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  # åå¤‡åŸŸåè§£ææœåŠ¡å™¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨å¢ƒå¤– DNS, ä¿è¯ç»“æœå¯ä¿¡
  # é…ç½® fallback åé»˜è®¤å¯ç”¨ fallback-filter,geoip-code ä¸º cn
  fallback:
    - https://dns.cloudflare.com/dns-query
    - https://1.1.1.1/dns-query
    - https://public.dns.iij.jp/dns-query
    - https://dns.oszx.co/dns-query
    - https://jp.tiarap.org/dns-query
    - tls://8.8.4.4
    - tls://1.1.1.1
  # åå¤‡åŸŸåè§£ææœåŠ¡å™¨ç­›é€‰ï¼Œæ»¡è¶³æ¡ä»¶çš„å°†ä½¿ç”¨ fallback ç»“æœæˆ–åªä½¿ç”¨ fallback è§£æ
  fallback-filter:
    geoip: true
    geoip-code: CN # å½“ nameserver åŸŸåçš„ IP æŸ¥è¯¢ geoip åº“ä¸º CN æ—¶ä¼šç›´æ¥é‡‡ç”¨ï¼Œå¦åˆ™å°†è¢«è§†ä¸ºè¢«æ±¡æŸ“,é‡‡ç”¨ fallback ç»“æœ
    geosite: # geosite åˆ—è¡¨çš„å†…å®¹è¢«è§†ä¸ºå·²æ±¡æŸ“ï¼ŒåŒ¹é…åˆ° geosite çš„åŸŸåï¼Œå°†åªä½¿ç”¨ fallback è§£æï¼Œä¸å»ä½¿ç”¨ nameserver
      - gfw
    ipcidr: # è¿™äº›ç½‘æ®µçš„ç»“æœä¼šè¢«è§†ä¸ºæ±¡æŸ“ï¼Œnameserver è§£æå‡ºè¿™äº›ç»“æœæ—¶å°†ä¼šé‡‡ç”¨ fallback çš„è§£æç»“æœ
      - 0.0.0.0/8
      - 10.0.0.0/8
      - 100.64.0.0/10
      - 127.0.0.0/8
      - 169.254.0.0/16
      - 172.16.0.0/12
      - 192.0.0.0/24
      - 192.0.2.0/24
      - 192.88.99.0/24
      - 192.168.0.0/16
      - 198.18.0.0/15
      - 198.51.100.0/24
      - 203.0.113.0/24
      - 224.0.0.0/4
      - 240.0.0.0/4
      - 255.255.255.255/32
    domain: # è¿™äº›åŸŸåè¢«è§†ä¸ºå·²æ±¡æŸ“ï¼ŒåŒ¹é…åˆ°è¿™äº›åŸŸåï¼Œä¼šç›´æ¥ä½¿ç”¨ fallback è§£æï¼Œä¸å»ä½¿ç”¨ nameserver
      - '+.google.com'
      - "+.youtube.com"
      - "+.facebook.com"
      - "+.meta.com"
      - "+.reddit.com"
      - "+.netflix.com"
      - "+.hulu.com"
      - "+.disneyplus.com"
      - "+.openai.com"
      - "+.githubusercontent.com"
      - "+.googlevideo.com"
      - "+.msftconnecttest.com"
      - "+.msftncsi.com"

# Loyalsoldier è§„åˆ™é›†
# https://github.com/Loyalsoldier/clash-rules
rule-providers:
  # reject:
  #   type: http
  #   behavior: domain
  #   url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"
  #   path: ./ruleset/reject.yaml
  #   interval: 86400

  icloud:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"
    path: ./ruleset/icloud.yaml
    interval: 86400

  apple:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"
    path: ./ruleset/apple.yaml
    interval: 86400

  # google:
  #   type: http
  #   behavior: domain
  #   url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt"
  #   path: ./ruleset/google.yaml
  #   interval: 86400

  proxy:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"
    path: ./ruleset/proxy.yaml
    interval: 86400

  direct:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"
    path: ./ruleset/direct.yaml
    interval: 86400

  private:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: ./ruleset/private.yaml
    interval: 86400

  gfw:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"
    path: ./ruleset/gfw.yaml
    interval: 86400

  tld-not-cn:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"
    path: ./ruleset/tld-not-cn.yaml
    interval: 86400

  telegramcidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"
    path: ./ruleset/telegramcidr.yaml
    interval: 86400

  cncidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./ruleset/cncidr.yaml
    interval: 86400

  lancidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: ./ruleset/lancidr.yaml
    interval: 86400

  applications:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"
    path: ./ruleset/applications.yaml
    interval: 86400

rules:
  - RULE-SET,applications,DIRECT
  - DOMAIN,clash.razord.top,DIRECT
  - DOMAIN,yacd.haishan.me,DIRECT
  - RULE-SET,lancidr,DIRECT
  - RULE-SET,private,DIRECT
  - RULE-SET,direct,DIRECT
  - RULE-SET,cncidr,DIRECT
  # - RULE-SET,reject,REJECT # å»å¹¿å‘Š
  - RULE-SET,icloud,DIRECT
  - RULE-SET,apple,DIRECT
  # - RULE-SET,google,DIRECT
  - RULE-SET,proxy,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,telegramcidr,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - GEOIP,LAN,DIRECT